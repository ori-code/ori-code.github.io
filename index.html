    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Visualizer 1.0 | The Faith Sound</title>
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        
        <script src="https://unpkg.com/feather-icons"></script>
        
    <script src="https://www.paypal.com/sdk/js?client-id=AUjr_VTe9_mnojYbrv2wEhvIlYN3nXES7HG2hIfHpNhZchdcNGCh6WeHJtxwXkDBqS09gb2RjX-HAYEK&currency=USD"></script>

        <style>
            :root {
                --color-background: #0D0C12;
                --color-surface: #1C1B22;
                --color-primary: #FF3B5C;
                --color-primary-glow: rgba(255, 59, 92, 0.4);
                --color-text: #EAEAEA;
                --color-text-muted: #88878D;
                --font-family: 'Poppins', sans-serif;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            html {
                scroll-behavior: smooth;
            }

            body {
                background-color: var(--color-background);
                color: var(--color-text);
                font-family: var(--font-family);
                overflow-x: hidden;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 0 24px;
            }

            /* --- Animations --- */
            .reveal {
                opacity: 0;
                transform: translateY(30px);
                transition: opacity 0.8s ease-out, transform 0.6s ease-out;
            }

            .reveal.visible {
                opacity: 1;
                transform: translateY(0);
            }

            /* --- Header --- */
            .header {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                z-index: 100;
                padding: 20px 0;
                background: rgba(13, 12, 18, 0.7);
                backdrop-filter: blur(10px);
                border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            }

            .nav {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .nav-logo {
                font-size: 1.5rem;
                font-weight: 600;
                color: var(--color-text);
                text-decoration: none;
            }
            .nav-logo span {
                color: var(--color-primary);
            }

            .nav-menu {
                display: flex;
                align-items: center;
                gap: 32px;
                list-style: none;
            }

            .nav-link {
                color: var(--color-text-muted);
                text-decoration: none;
                font-weight: 500;
                transition: color 0.3s ease;
            }
            .nav-link:hover {
                color: var(--color-text);
            }

            .nav-cta {
                background: var(--color-primary);
                color: #FFF;
                padding: 10px 24px;
                border-radius: 8px;
                text-decoration: none;
                font-weight: 600;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px var(--color-primary-glow);
            }
            .nav-cta:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 20px var(--color-primary-glow);
            }

            /* --- Hero Section --- */
            .hero {
                position: relative;
                padding: 180px 0 100px;
                text-align: center;
                overflow: hidden;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            
            .hero-aurora {
                position: absolute;
                top: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 800px;
                height: 600px;
                background: radial-gradient(circle, var(--color-primary-glow) 0%, transparent 60%);
                z-index: 0;
                animation: pulse 8s infinite ease-in-out;
            }

            @keyframes pulse {
                0% { transform: translateX(-50%) scale(1); opacity: 0.7; }
                50% { transform: translateX(-50%) scale(1.2); opacity: 1; }
                100% { transform: translateX(-50%) scale(1); opacity: 0.7; }
            }
            
            .hero-content {
                position: relative;
                z-index: 1;
            }

            .hero h1 {
                font-size: 4.5rem;
                font-weight: 700;
                letter-spacing: -2px;
                line-height: 1.1;
                background: linear-gradient(120deg, var(--color-primary), #FFF);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                margin-bottom: 24px;
            }

            .hero p {
                font-size: 1.25rem;
                color: var(--color-text-muted);
                max-width: 650px;
                margin: 0 auto 40px;
                line-height: 1.6;
            }

            .hero-image-container {
                margin-top: 60px;
                position: relative;
                z-index: 2;
            }

            .hero-image {
                width: 100%;
                max-width: 800px;
                border-radius: 12px;
                box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            /* --- Section --- */
            .section {
                padding: 100px 0;
            }

            .section-title {
                text-align: center;
                font-size: 2.5rem;
                font-weight: 600;
                margin-bottom: 12px;
            }

            .section-subtitle {
                text-align: center;
                font-size: 1.1rem;
                color: var(--color-text-muted);
                margin-bottom: 60px;
            }

            /* --- Features Section --- */
            .features-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 30px;
            }

            .feature-card {
                background: rgba(28, 27, 34, 0.5);
                border: 1px solid rgba(255, 255, 255, 0.08);
                backdrop-filter: blur(5px);
                padding: 32px;
                border-radius: 16px;
                transition: all 0.3s ease;
            }
            .feature-card:hover {
                transform: translateY(-5px);
                border-color: rgba(255, 59, 92, 0.5);
            }

            .feature-icon {
                width: 48px;
                height: 48px;
                color: var(--color-primary);
                margin-bottom: 24px;
            }
            
            .feature-card h3 {
                font-size: 1.5rem;
                margin-bottom: 12px;
                color: var(--color-text);
            }

            .feature-card p {
                color: var(--color-text-muted);
                line-height: 1.7;
            }
            
            /* --- Demo Section --- */
            .demo-video-wrapper {
                position: relative;
                padding-top: 56.25%; /* 16:9 Aspect Ratio */
                border-radius: 16px;
                overflow: hidden;
                box-shadow: 0 15px 40px rgba(0,0,0,0.4);
                border: 1px solid rgba(255,255,255,0.1);
            }
            .demo-video-wrapper iframe {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border: 0;
            }

            /* --- Pricing Section --- */
            .pricing-card {
                background: linear-gradient(145deg, var(--color-surface), var(--color-background));
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 20px;
                max-width: 450px;
                margin: 0 auto;
                padding: 40px;
                text-align: center;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            }

            .pricing-card h3 {
                font-size: 1.75rem;
                font-weight: 600;
            }
            
            .pricing-price {
                font-size: 4rem;
                font-weight: 700;
                color: var(--color-primary);
                margin: 20px 0;
            }
            .pricing-price span {
                font-size: 1rem;
                font-weight: 400;
                color: var(--color-text-muted);
            }
            
            .pricing-features {
                list-style: none;
                margin: 30px 0;
                text-align: left;
                display: inline-block;
            }

            .pricing-features li {
                margin-bottom: 12px;
                color: var(--color-text-muted);
                display: flex;
                align-items: center;
                gap: 12px;
            }
            .pricing-features .icon {
                color: var(--color-primary);
                width: 20px;
                height: 20px;
            }

            .pricing-cta {
                display: block;
                width: 100%;
                padding: 16px;
                margin-top: 20px;
            }

            /* --- Footer --- */
            .footer {
                padding: 50px 0;
                border-top: 1px solid rgba(255, 255, 255, 0.05);
                text-align: center;
            }
            .footer p {
                color: var(--color-text-muted);
                font-size: 0.9rem;
            }
            
            /* --- Responsive --- */
            @media (max-width: 768px) {
                .nav-menu {
                    display: none; /* For simplicity, hiding menu. A hamburger menu would be ideal for a real site. */
                }
                .hero h1 {
                    font-size: 3rem;
                }
                .hero p {
                    font-size: 1rem;
                }
            }

        </style>
    </head>

    <!-- CHAT -->

  <!-- Enhanced Chat Widget -->
<button id="chat-toggle">ðŸ’¬</button>
<div id="chat-widget">
    <div id="chat-header">
        <span>ðŸ’¬ Chat with Us</span>
        <button id="chat-close">Ã—</button>
    </div>
    <div id="chat-body"></div>
    <div id="chat-input-container">
        <input type="text" id="chat-input" placeholder="Type your message..." />
        <button id="chat-send">Send</button>
    </div>
</div>

<style>
/* Enhanced Chat Widget Styles */
#chat-toggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    background: var(--color-primary);
    border: none;
    border-radius: 50%;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    box-shadow: 0 4px 20px var(--color-primary-glow);
    z-index: 1001;
    transition: all 0.3s ease;
}

#chat-toggle:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 25px var(--color-primary-glow);
}

#chat-widget {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 350px;
    max-width: calc(100vw - 40px);
    background: #1C1B22;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px;
    overflow: hidden;
    font-family: 'Poppins', sans-serif;
    box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    z-index: 1000;
    transform: translateY(100%);
    opacity: 0;
    transition: all 0.3s ease;
}

#chat-widget.open {
    transform: translateY(0);
    opacity: 1;
}

#chat-header {
    background: var(--color-primary);
    color: white;
    padding: 15px;
    font-weight: bold;
    text-align: center;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#chat-close {
    background: none;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.3s ease;
}

#chat-close:hover {
    background: rgba(255,255,255,0.2);
}

#chat-body {
    height: 300px;
    overflow-y: auto;
    padding: 15px;
    color: #EAEAEA;
    background: var(--color-surface);
}

#chat-body::-webkit-scrollbar {
    width: 6px;
}

#chat-body::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.1);
}

#chat-body::-webkit-scrollbar-thumb {
    background: var(--color-primary);
    border-radius: 3px;
}

.chat-msg {
    margin-bottom: 15px;
    padding: 12px 16px;
    border-radius: 18px;
    max-width: 85%;
    word-wrap: break-word;
    line-height: 1.4;
    animation: messageSlide 0.3s ease;
}

@keyframes messageSlide {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.chat-msg.user {
    background: var(--color-primary);
    color: white;
    margin-left: auto;
    text-align: right;
    border-bottom-right-radius: 4px;
}

.chat-msg.bot {
    background: rgba(255,255,255,0.1);
    color: var(--color-text);
    border-bottom-left-radius: 4px;
}

.chat-msg.typing {
    background: rgba(255,255,255,0.05);
    color: var(--color-text-muted);
    font-style: italic;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
}

#chat-input-container {
    display: flex;
    border-top: 1px solid rgba(255,255,255,0.1);
    background: var(--color-surface);
}

#chat-input {
    flex: 1;
    padding: 15px;
    border: none;
    outline: none;
    background: transparent;
    color: white;
    font-family: inherit;
    font-size: 14px;
}

#chat-input::placeholder {
    color: var(--color-text-muted);
}

#chat-input:disabled {
    opacity: 0.6;
}

#chat-send {
    background: var(--color-primary);
    color: white;
    border: none;
    padding: 15px 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    min-width: 60px;
}

#chat-send:hover:not(:disabled) {
    background: #e6345a;
    transform: translateX(-2px);
}

#chat-send:disabled {
    background: #666;
    cursor: not-allowed;
    transform: none;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    #chat-widget {
        width: calc(100vw - 20px);
        right: 10px;
        left: 10px;
        bottom: 10px;
    }
    
    #chat-toggle {
        right: 20px;
        bottom: 20px;
        width: 55px;
        height: 55px;
        font-size: 1.3rem;
    }
    
    #chat-body {
        height: 250px;
    }
}

@media (max-width: 480px) {
    #chat-header {
        padding: 12px;
        font-size: 14px;
    }
    
    #chat-input {
        padding: 12px;
        font-size: 14px;
    }
    
    #chat-send {
        padding: 12px 16px;
        font-size: 14px;
    }
    
    .chat-msg {
        padding: 10px 14px;
        font-size: 14px;
    }
}
</style>

<!-- <script>
// Chat Widget (GitHub Pages + Local + Cloudflare Tunnel)
document.addEventListener('DOMContentLoaded', function() {
  const chatToggle = document.getElementById('chat-toggle');
  const chatWidget = document.getElementById('chat-widget');
  const chatClose  = document.getElementById('chat-close');
  const chatBody   = document.getElementById('chat-body');
  const chatInput  = document.getElementById('chat-input');
  const chatSend   = document.getElementById('chat-send');

  // ---- Configure your endpoints here ----
  const LOCAL_WEBHOOK = "http://localhost:5678/webhook/ai-chat";
  // Replace with your current tunnel; rotate as needed
  const PROD_WEBHOOK  = "https://validity-session-aggressive-tigers.trycloudflare.com/webhook/ai-chat";

  // Allow override via query string: ?webhook=https://.../webhook/ai-chat
  const qsWebhook = new URLSearchParams(location.search).get('webhook');

  // Decide by host: localhost â†’ local; anything else â†’ prod
  const byHost = (location.hostname === "localhost" || location.hostname === "127.0.0.1")
    ? LOCAL_WEBHOOK
    : PROD_WEBHOOK;

  // Initial pick
  let N8N_WEBHOOK_URL = qsWebhook || byHost;

  // Utility UI
  function appendMessage(text, sender) {
    const msg = document.createElement('div');
    msg.className = 'chat-msg ' + sender;
    msg.textContent = text;
    chatBody.appendChild(msg);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  function showTyping() {
    const typing = document.createElement('div');
    typing.className = 'chat-msg typing';
    typing.id = 'typing-indicator';
    typing.textContent = 'AI is typing...';
    chatBody.appendChild(typing);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  function hideTyping() {
    const t = document.getElementById('typing-indicator');
    if (t) t.remove();
  }
  function setProcessing(on) {
    chatSend.disabled = on;
    chatInput.disabled = on;
    chatSend.textContent = on ? '...' : 'Send';
  }

  // Send to webhook with auto-fallback (prod<->local) + timeouts
  async function sendToWebhook(payload) {
    const candidates = [N8N_WEBHOOK_URL,
      N8N_WEBHOOK_URL === LOCAL_WEBHOOK ? PROD_WEBHOOK : LOCAL_WEBHOOK
    ].filter(Boolean);

    let lastError;
    for (const url of candidates) {
      try {
        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 20000); // 20s
        const r = await fetch(url, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json, text/plain, */*'
          },
          body: JSON.stringify(payload),
          mode: "cors",
          signal: controller.signal
        });
        clearTimeout(timeout);
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        N8N_WEBHOOK_URL = url;               // stick to the one that worked
        const ct = r.headers.get('content-type') || '';
        return ct.includes('application/json') ? r.json() : r.text();
      } catch (e) {
        lastError = e;
      }
    }
    throw lastError || new Error('Request failed');
  }

  // UI open/close
  chatToggle.addEventListener('click', () => {
    chatWidget.classList.add('open');
    chatToggle.style.display = 'none';
    if (chatBody.children.length === 0) {
      setTimeout(() => appendMessage("Hello! ðŸ‘‹ Ask me anything about Visualizer 1.0.", 'bot'), 300);
    }
    setTimeout(() => chatInput.focus(), 100);
  });
  chatClose.addEventListener('click', () => {
    chatWidget.classList.remove('open');
    chatToggle.style.display = 'block';
  });

  async function sendMessage() {
    const message = chatInput.value.trim();
    if (!message || chatSend.disabled) return;

    setProcessing(true);
    appendMessage(message, 'user');
    chatInput.value = '';
    showTyping();

    const payload = {
      message,
      chatInput: message,
      body: { message, chatInput: message, timestamp: new Date().toISOString() },
      timestamp: new Date().toISOString(),
      user: "website-visitor"
    };

    try {
      const data = await sendToWebhook(payload);
      hideTyping();
      let reply = '';
      if (data && typeof data === 'object') {
        reply = data.response || data.answer || data.output || data.result || JSON.stringify(data, null, 2);
      } else {
        reply = String(data ?? '');
      }
      appendMessage(reply || "âœ… Message received.", 'bot');
    } catch (err) {
      hideTyping();
      console.error('Chat error:', err);
      const hint =
        err.name === 'AbortError' ? " (timeout)" :
        (String(err.message).includes('CORS') ? " (CORS blocked)" : "");
      appendMessage("Iâ€™m having trouble connecting right now" + hint + ". Please try again shortly.", 'bot');
      // Optional: show quick diagnostics
      appendMessage(`Diagnostics:
- Current page origin: ${location.origin}
- Current webhook: ${N8N_WEBHOOK_URL}
- Tip: Add your site origin to n8n Webhook â†’ Options â†’ Allowed Origins`, 'bot');
    } finally {
      setProcessing(false);
      chatInput.focus();
    }
  }

  chatSend.addEventListener('click', sendMessage);
  chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });
});
</script> -->

<!-- <script>
    // Chat Widget (GitHub Pages + Local + Cloudflare Tunnel)
document.addEventListener('DOMContentLoaded', function() {
  const chatToggle = document.getElementById('chat-toggle');
  const chatWidget = document.getElementById('chat-widget');
  const chatClose  = document.getElementById('chat-close');
  const chatBody   = document.getElementById('chat-body');
  const chatInput  = document.getElementById('chat-input');
  const chatSend   = document.getElementById('chat-send');

  // ---- Configure your endpoints here ----
  const LOCAL_WEBHOOK = "http://localhost:5678/webhook/ai-chat";
  // Replace with your current tunnel; rotate as needed
  const PROD_WEBHOOK  = "https://platinum-cold-wine-advert.trycloudflare.com/webhook/ai-chat";

  // Allow override via query string: ?webhook=https://.../webhook/ai-chat
  const qsWebhook = new URLSearchParams(location.search).get('webhook');

  // Improved host detection - treat file:// protocol as local development
  const isLocal = (location.hostname === "localhost" || 
                   location.hostname === "127.0.0.1" || 
                   location.protocol === "file:");
  
  const byHost = isLocal ? LOCAL_WEBHOOK : PROD_WEBHOOK;

  // Initial pick
  let N8N_WEBHOOK_URL = qsWebhook || byHost;

  // Utility UI functions
  function appendMessage(text, sender) {
    const msg = document.createElement('div');
    msg.className = 'chat-msg ' + sender;
    msg.textContent = text;
    chatBody.appendChild(msg);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  
  function showTyping() {
    const typing = document.createElement('div');
    typing.className = 'chat-msg typing';
    typing.id = 'typing-indicator';
    typing.textContent = 'AI is typing...';
    chatBody.appendChild(typing);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  
  function hideTyping() {
    const t = document.getElementById('typing-indicator');
    if (t) t.remove();
  }
  
  function setProcessing(on) {
    chatSend.disabled = on;
    chatInput.disabled = on;
    chatSend.textContent = on ? '...' : 'Send';
  }

  // Send to webhook with auto-fallback (prod<->local) + timeouts
  async function sendToWebhook(payload) {
    const candidates = [N8N_WEBHOOK_URL,
      N8N_WEBHOOK_URL === LOCAL_WEBHOOK ? PROD_WEBHOOK : LOCAL_WEBHOOK
    ].filter(Boolean);

    let lastError;
    for (const url of candidates) {
      try {
        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 20000); // 20s
        
        // Enhanced fetch options for better CORS handling
        const fetchOptions = {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json, text/plain, */*'
          },
          body: JSON.stringify(payload),
          signal: controller.signal
        };

        // Only add CORS mode if not file:// protocol
        if (location.protocol !== "file:") {
          fetchOptions.mode = "cors";
        }

        const r = await fetch(url, fetchOptions);
        clearTimeout(timeout);
        
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        
        N8N_WEBHOOK_URL = url; // stick to the one that worked
        const ct = r.headers.get('content-type') || '';
        return ct.includes('application/json') ? r.json() : r.text();
      } catch (e) {
        lastError = e;
        console.warn(`Failed to connect to ${url}:`, e.message);
      }
    }
    throw lastError || new Error('Request failed');
  }

  // UI open/close
  chatToggle.addEventListener('click', () => {
    chatWidget.classList.add('open');
    chatToggle.style.display = 'none';
    if (chatBody.children.length === 0) {
      setTimeout(() => {
        let welcomeMsg = "Hello! ðŸ‘‹ Ask me anything about Visualizer 1.0.";
        if (location.protocol === "file:") {
          welcomeMsg += "\n\nðŸ’¡ Tip: For better performance, serve this page through a local web server instead of opening the file directly.";
        }
        appendMessage(welcomeMsg, 'bot');
      }, 300);
    }
    setTimeout(() => chatInput.focus(), 100);
  });
  
  chatClose.addEventListener('click', () => {
    chatWidget.classList.remove('open');
    chatToggle.style.display = 'block';
  });

  async function sendMessage() {
    const message = chatInput.value.trim();
    if (!message || chatSend.disabled) return;

    setProcessing(true);
    appendMessage(message, 'user');
    chatInput.value = '';
    showTyping();

    const payload = {
      message,
      chatInput: message,
      body: { message, chatInput: message, timestamp: new Date().toISOString() },
      timestamp: new Date().toISOString(),
      user: "website-visitor",
      origin: location.origin || "file://" // Include origin info for debugging
    };

    try {
      const data = await sendToWebhook(payload);
      hideTyping();
      let reply = '';
      if (data && typeof data === 'object') {
        reply = data.response || data.answer || data.output || data.result || JSON.stringify(data, null, 2);
      } else {
        reply = String(data ?? '');
      }
      appendMessage(reply || "âœ… Message received.", 'bot');
    } catch (err) {
      hideTyping();
      console.error('Chat error:', err);
      
      let errorMessage = "I'm having trouble connecting right now";
      let diagnostics = "";
      
      if (err.name === 'AbortError') {
        errorMessage += " (timeout)";
      } else if (String(err.message).includes('CORS')) {
        errorMessage += " (CORS blocked)";
      } else if (location.protocol === "file:") {
        errorMessage += " (file:// protocol issues)";
        diagnostics = `\n\nðŸ”§ To fix this:
1. Serve this page through a web server:
   - Python: python -m http.server 8000
   - Node: npx http-server -p 8000
   - Then open http://localhost:8000

2. Or configure n8n webhook CORS to allow file:// origin`;
      }
      
      errorMessage += ". Please try again shortly.";
      appendMessage(errorMessage + diagnostics, 'bot');
      
      // Show diagnostics if file:// or development
      if (location.protocol === "file:" || isLocal) {
        appendMessage(`Diagnostics:
- Current page origin: ${location.origin || location.protocol + "//" + (location.host || "local-file")}
- Current webhook: ${N8N_WEBHOOK_URL}
- Protocol: ${location.protocol}`, 'bot');
      }
    } finally {
      setProcessing(false);
      chatInput.focus();
    }
  }

  chatSend.addEventListener('click', sendMessage);
  chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });
});
</script>         -->

<!-- <script>
// Chat Widget with Memory Functionality
document.addEventListener('DOMContentLoaded', function() {
  const chatToggle = document.getElementById('chat-toggle');
  const chatWidget = document.getElementById('chat-widget');
  const chatClose  = document.getElementById('chat-close');
  const chatBody   = document.getElementById('chat-body');
  const chatInput  = document.getElementById('chat-input');
  const chatSend   = document.getElementById('chat-send');

  // Generate or retrieve persistent session ID for conversation memory
  let SESSION_ID = localStorage.getItem('chatSessionId');
  if (!SESSION_ID) {
    SESSION_ID = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    localStorage.setItem('chatSessionId', SESSION_ID);
    console.log('New chat session created:', SESSION_ID);
  } else {
    console.log('Existing chat session loaded:', SESSION_ID);
  }

  // ---- Configure your endpoints here ----
  const LOCAL_WEBHOOK = "http://localhost:5678/webhook/ai-chat";
  // Replace with your current tunnel; rotate as needed
  const PROD_WEBHOOK  = "https://platinum-cold-wine-advert.trycloudflare.com/webhook/ai-chat";

  // Allow override via query string: ?webhook=https://.../webhook/ai-chat
  const qsWebhook = new URLSearchParams(location.search).get('webhook');

  // Improved host detection - treat file:// protocol as local development
  const isLocal = (location.hostname === "localhost" || 
                   location.hostname === "127.0.0.1" || 
                   location.protocol === "file:");
  
  const byHost = isLocal ? LOCAL_WEBHOOK : PROD_WEBHOOK;

  // Initial pick
  let N8N_WEBHOOK_URL = qsWebhook || byHost;

  // Utility UI functions
  function appendMessage(text, sender) {
    const msg = document.createElement('div');
    msg.className = 'chat-msg ' + sender;
    msg.textContent = text;
    chatBody.appendChild(msg);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  
  function showTyping() {
    const typing = document.createElement('div');
    typing.className = 'chat-msg typing';
    typing.id = 'typing-indicator';
    typing.textContent = 'AI is typing...';
    chatBody.appendChild(typing);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  
  function hideTyping() {
    const t = document.getElementById('typing-indicator');
    if (t) t.remove();
  }
  
  function setProcessing(on) {
    chatSend.disabled = on;
    chatInput.disabled = on;
    chatSend.textContent = on ? '...' : 'Send';
  }

  // Load previous conversation from localStorage
  function loadChatHistory() {
    const chatHistory = localStorage.getItem('chatHistory_' + SESSION_ID);
    if (chatHistory) {
      try {
        const messages = JSON.parse(chatHistory);
        messages.forEach(msg => {
          appendMessage(msg.text, msg.sender);
        });
        console.log('Chat history loaded:', messages.length, 'messages');
      } catch (e) {
        console.warn('Failed to load chat history:', e);
      }
    }
  }

  // Save message to localStorage
  function saveMessageToHistory(text, sender) {
    try {
      const historyKey = 'chatHistory_' + SESSION_ID;
      let history = [];
      const existingHistory = localStorage.getItem(historyKey);
      if (existingHistory) {
        history = JSON.parse(existingHistory);
      }
      
      history.push({ text, sender, timestamp: new Date().toISOString() });
      
      // Keep only last 50 messages to avoid localStorage bloat
      if (history.length > 50) {
        history = history.slice(-50);
      }
      
      localStorage.setItem(historyKey, JSON.stringify(history));
    } catch (e) {
      console.warn('Failed to save message to history:', e);
    }
  }

  // Clear session and start fresh
  function clearSession() {
    localStorage.removeItem('chatSessionId');
    localStorage.removeItem('chatHistory_' + SESSION_ID);
    location.reload();
  }

  // Send to webhook with auto-fallback (prod<->local) + timeouts
  async function sendToWebhook(payload) {
    const candidates = [N8N_WEBHOOK_URL,
      N8N_WEBHOOK_URL === LOCAL_WEBHOOK ? PROD_WEBHOOK : LOCAL_WEBHOOK
    ].filter(Boolean);

    let lastError;
    for (const url of candidates) {
      try {
        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 20000); // 20s
        
        // Enhanced fetch options for better CORS handling
        const fetchOptions = {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json, text/plain, */*'
          },
          body: JSON.stringify(payload),
          signal: controller.signal
        };

        // Only add CORS mode if not file:// protocol
        if (location.protocol !== "file:") {
          fetchOptions.mode = "cors";
        }

        const r = await fetch(url, fetchOptions);
        clearTimeout(timeout);
        
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        
        N8N_WEBHOOK_URL = url; // stick to the one that worked
        const ct = r.headers.get('content-type') || '';
        return ct.includes('application/json') ? r.json() : r.text();
      } catch (e) {
        lastError = e;
        console.warn(`Failed to connect to ${url}:`, e.message);
      }
    }
    throw lastError || new Error('Request failed');
  }

  // Enhanced appendMessage that also saves to history
  function appendMessageWithHistory(text, sender) {
    appendMessage(text, sender);
    saveMessageToHistory(text, sender);
  }

  // UI open/close
  chatToggle.addEventListener('click', () => {
    chatWidget.classList.add('open');
    chatToggle.style.display = 'none';
    
    // Load chat history if chat is empty
    if (chatBody.children.length === 0) {
      loadChatHistory();
      
      // If still no messages, show welcome
      if (chatBody.children.length === 0) {
        setTimeout(() => {
          let welcomeMsg = "Hello! ðŸ‘‹ Ask me anything about Visualizer 1.0.";
          if (location.protocol === "file:") {
            welcomeMsg += "\n\nðŸ’¡ Tip: For better performance, serve this page through a local web server instead of opening the file directly.";
          }
          appendMessageWithHistory(welcomeMsg, 'bot');
        }, 300);
      }
    }
    setTimeout(() => chatInput.focus(), 100);
  });
  
  chatClose.addEventListener('click', () => {
    chatWidget.classList.remove('open');
    chatToggle.style.display = 'block';
  });

  // Add clear session button (optional - for testing)
  function addClearButton() {
    const clearBtn = document.createElement('button');
    clearBtn.textContent = 'ðŸ—‘ï¸ Clear History';
    clearBtn.style.cssText = `
      position: absolute;
      top: 5px;
      right: 40px;
      background: rgba(255,255,255,0.1);
      border: none;
      color: white;
      padding: 5px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    `;
    clearBtn.onclick = clearSession;
    document.querySelector('#chat-header').appendChild(clearBtn);
  }

  async function sendMessage() {
    const message = chatInput.value.trim();
    if (!message || chatSend.disabled) return;

    setProcessing(true);
    appendMessageWithHistory(message, 'user'); // Save user message to history
    chatInput.value = '';
    showTyping();

    const payload = {
      message,
      chatInput: message,
      sessionId: SESSION_ID, // Critical: Include session ID for n8n memory
      body: { 
        message, 
        chatInput: message, 
        sessionId: SESSION_ID, // Also in body for compatibility
        timestamp: new Date().toISOString() 
      },
      timestamp: new Date().toISOString(),
      user: "website-visitor",
      origin: location.origin || "file://" // Include origin info for debugging
    };

    try {
      const data = await sendToWebhook(payload);
      hideTyping();
      let reply = '';
      if (data && typeof data === 'object') {
        reply = data.response || data.answer || data.output || data.result || JSON.stringify(data, null, 2);
      } else {
        reply = String(data ?? '');
      }
      const finalReply = reply || "âœ… Message received.";
      appendMessageWithHistory(finalReply, 'bot'); // Save bot response to history
    } catch (err) {
      hideTyping();
      console.error('Chat error:', err);
      
      let errorMessage = "I'm having trouble connecting right now";
      let diagnostics = "";
      
      if (err.name === 'AbortError') {
        errorMessage += " (timeout)";
      } else if (String(err.message).includes('CORS')) {
        errorMessage += " (CORS blocked)";
      } else if (location.protocol === "file:") {
        errorMessage += " (file:// protocol issues)";
        diagnostics = `\n\nðŸ”§ To fix this:
1. Serve this page through a web server:
   - Python: python -m http.server 8000
   - Node: npx http-server -p 8000
   - Then open http://localhost:8000

2. Or configure n8n webhook CORS to allow file:// origin`;
      }
      
      errorMessage += ". Please try again shortly.";
      appendMessageWithHistory(errorMessage + diagnostics, 'bot');
      
      // Show diagnostics if file:// or development
      if (location.protocol === "file:" || isLocal) {
        appendMessageWithHistory(`Diagnostics:
- Current page origin: ${location.origin || location.protocol + "//" + (location.host || "local-file")}
- Current webhook: ${N8N_WEBHOOK_URL}
- Protocol: ${location.protocol}
- Session ID: ${SESSION_ID}`, 'bot');
      }
    } finally {
      setProcessing(false);
      chatInput.focus();
    }
  }

  chatSend.addEventListener('click', sendMessage);
  chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  // Optional: Add clear button for testing
  setTimeout(() => {
    if (document.querySelector('#chat-header')) {
      addClearButton();
    }
  }, 1000);

  // Debug info
  console.log('Chat initialized with memory functionality');
  console.log('Session ID:', SESSION_ID);
  console.log('Webhook URL:', N8N_WEBHOOK_URL);
});
</script> -->
 
<!-- Replace the existing chat script in your HTML with this updated version -->
<script>
// Chat Widget with Memory Functionality - UPDATED
document.addEventListener('DOMContentLoaded', function() {
  const chatToggle = document.getElementById('chat-toggle');
  const chatWidget = document.getElementById('chat-widget');
  const chatClose  = document.getElementById('chat-close');
  const chatBody   = document.getElementById('chat-body');
  const chatInput  = document.getElementById('chat-input');
  const chatSend   = document.getElementById('chat-send');

  // Generate or retrieve persistent session ID for conversation memory
  let SESSION_ID = localStorage.getItem('chatSessionId');
  if (!SESSION_ID) {
    SESSION_ID = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    localStorage.setItem('chatSessionId', SESSION_ID);
    console.log('New chat session created:', SESSION_ID);
  } else {
    console.log('Existing chat session loaded:', SESSION_ID);
  }

  // ---- UPDATED WEBHOOK URLS ----
  const LOCAL_WEBHOOK = "http://localhost:5678/webhook/ai-chat";
  
  // ðŸ”¥ UPDATE THIS URL to match your actual n8n instance
  // If using Cloudflare tunnel, replace with your current tunnel URL
  // If using ngrok, replace with your ngrok URL  
  // If using direct n8n access, use your n8n instance URL
  const PROD_WEBHOOK = "https://get-franchise-deaths-logging.trycloudflare.com/webhook/ai-chat";
  
  // For example:
  // const PROD_WEBHOOK = "https://your-domain.com/webhook/ai-chat";
  // const PROD_WEBHOOK = "https://abc123.ngrok.io/webhook/ai-chat";
  // const PROD_WEBHOOK = "https://new-tunnel-url.trycloudflare.com/webhook/ai-chat";

  // Allow override via query string: ?webhook=https://.../webhook/ai-chat
  const qsWebhook = new URLSearchParams(location.search).get('webhook');

  // Improved host detection
  const isLocal = (location.hostname === "localhost" || 
                   location.hostname === "127.0.0.1" || 
                   location.protocol === "file:");
  
  const byHost = isLocal ? LOCAL_WEBHOOK : PROD_WEBHOOK;
  let N8N_WEBHOOK_URL = qsWebhook || byHost;

  // Rest of your chat functionality remains the same...
  function appendMessage(text, sender) {
    const msg = document.createElement('div');
    msg.className = 'chat-msg ' + sender;
    msg.textContent = text;
    chatBody.appendChild(msg);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  
  function showTyping() {
    const typing = document.createElement('div');
    typing.className = 'chat-msg typing';
    typing.id = 'typing-indicator';
    typing.textContent = 'AI is typing...';
    chatBody.appendChild(typing);
    chatBody.scrollTop = chatBody.scrollHeight;
  }
  
  function hideTyping() {
    const t = document.getElementById('typing-indicator');
    if (t) t.remove();
  }
  
  function setProcessing(on) {
    chatSend.disabled = on;
    chatInput.disabled = on;
    chatSend.textContent = on ? '...' : 'Send';
  }

  function loadChatHistory() {
    const chatHistory = localStorage.getItem('chatHistory_' + SESSION_ID);
    if (chatHistory) {
      try {
        const messages = JSON.parse(chatHistory);
        messages.forEach(msg => {
          appendMessage(msg.text, msg.sender);
        });
        console.log('Chat history loaded:', messages.length, 'messages');
      } catch (e) {
        console.warn('Failed to load chat history:', e);
      }
    }
  }

  function saveMessageToHistory(text, sender) {
    try {
      const historyKey = 'chatHistory_' + SESSION_ID;
      let history = [];
      const existingHistory = localStorage.getItem(historyKey);
      if (existingHistory) {
        history = JSON.parse(existingHistory);
      }
      
      history.push({ text, sender, timestamp: new Date().toISOString() });
      
      if (history.length > 50) {
        history = history.slice(-50);
      }
      
      localStorage.setItem(historyKey, JSON.stringify(history));
    } catch (e) {
      console.warn('Failed to save message to history:', e);
    }
  }

  async function sendToWebhook(payload) {
    const candidates = [N8N_WEBHOOK_URL,
      N8N_WEBHOOK_URL === LOCAL_WEBHOOK ? PROD_WEBHOOK : LOCAL_WEBHOOK
    ].filter(Boolean);

    let lastError;
    for (const url of candidates) {
      try {
        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 20000);
        
        const fetchOptions = {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json, text/plain, */*'
          },
          body: JSON.stringify(payload),
          signal: controller.signal
        };

        if (location.protocol !== "file:") {
          fetchOptions.mode = "cors";
        }

        const r = await fetch(url, fetchOptions);
        clearTimeout(timeout);
        
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        
        N8N_WEBHOOK_URL = url;
        const ct = r.headers.get('content-type') || '';
        return ct.includes('application/json') ? r.json() : r.text();
      } catch (e) {
        lastError = e;
        console.warn(`Failed to connect to ${url}:`, e.message);
      }
    }
    throw lastError || new Error('Request failed');
  }

  function appendMessageWithHistory(text, sender) {
    appendMessage(text, sender);
    saveMessageToHistory(text, sender);
  }

  chatToggle.addEventListener('click', () => {
    chatWidget.classList.add('open');
    chatToggle.style.display = 'none';
    
    if (chatBody.children.length === 0) {
      loadChatHistory();
      
      if (chatBody.children.length === 0) {
        setTimeout(() => {
          appendMessageWithHistory("Hello! I'm here to help with Visualizer 1.0. I remember our previous conversations!", 'bot');
        }, 300);
      }
    }
    setTimeout(() => chatInput.focus(), 100);
  });
  
  chatClose.addEventListener('click', () => {
    chatWidget.classList.remove('open');
    chatToggle.style.display = 'block';
  });

  async function sendMessage() {
    const message = chatInput.value.trim();
    if (!message || chatSend.disabled) return;

    setProcessing(true);
    appendMessageWithHistory(message, 'user');
    chatInput.value = '';
    showTyping();

    // ðŸ”¥ CRITICAL: Include sessionId for n8n memory
    const payload = {
      message,
      chatInput: message,
      sessionId: SESSION_ID, // This enables memory in your n8n workflow
      userId: SESSION_ID,    // Backup field name
      chatId: SESSION_ID,    // Another backup field name
      body: { 
        message, 
        chatInput: message, 
        sessionId: SESSION_ID,
        timestamp: new Date().toISOString() 
      },
      timestamp: new Date().toISOString(),
      user: "website-visitor",
      origin: location.origin || "file://"
    };

    try {
      const data = await sendToWebhook(payload);
      hideTyping();
      let reply = '';
      if (data && typeof data === 'object') {
        reply = data.response || data.answer || data.output || data.result || JSON.stringify(data, null, 2);
      } else {
        reply = String(data ?? '');
      }
      const finalReply = reply || "Message received.";
      appendMessageWithHistory(finalReply, 'bot');
    } catch (err) {
      hideTyping();
      console.error('Chat error:', err);
      
      let errorMessage = "I'm having trouble connecting right now. Please try again shortly.";
      appendMessageWithHistory(errorMessage, 'bot');
      
      // Debug info
      console.log('Debug Info:');
      console.log('- Session ID:', SESSION_ID);
      console.log('- Webhook URL:', N8N_WEBHOOK_URL);
      console.log('- Error:', err.message);
    } finally {
      setProcessing(false);
      chatInput.focus();
    }
  }

  chatSend.addEventListener('click', sendMessage);
  chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  console.log('Chat initialized with memory functionality');
  console.log('Session ID:', SESSION_ID);
  console.log('Webhook URL:', N8N_WEBHOOK_URL);
});
</script>

<body>

        <header class="header">
            <nav class="nav container">
                <a href="#" class="nav-logo">THE FAITH <span>SOUND</span></a>
                <ul class="nav-menu">
                    <li><a href="#features" class="nav-link">Features</a></li>
                    <li><a href="#demo" class="nav-link">Demo</a></li>
                    <li><a href="#pricing" class="nav-link">Pricing</a></li>
                </ul>
                <a href="#pricing" class="nav-cta">Buy Now</a>
            </nav>
        </header>

        <main>
            <section id="home" class="hero">
                <div class="hero-aurora"></div>
                <div class="hero-content container">
                    <h1 class="reveal">Visualize Your Sound.</h1>
                    <p class="reveal" style="transition-delay: 0.1s;">Visualizer 1.0 is a revolutionary FX plugin that provides seamless, real-time visual feedback for your MIDI controller, inspired by the legendary Korg NanoKontrol2.</p>
                    <div class="reveal" style="transition-delay: 0.2s;">
                        <a href="#pricing" class="nav-cta">Get Your Copy Now of Visualizer 1.0</a>
                    </div>
                </div>
                <div class="hero-image-container container reveal" style="transition-delay: 0.3s;">
                    <img src="https://res.cloudinary.com/dmylbfztz/image/upload/v1748356162/Photo_With_Plugin_Small_Size_w5kmri.jpg" alt="Visualizer 1.0 Plugin Interface" class="hero-image">
                </div>
            </section>

            <section id="features" class="section">
                <div class="container">
                    <h2 class="section-title reveal">Unparalleled Control & Clarity</h2>
                    <p class="section-subtitle reveal">Everything you need for an intuitive and efficient production workflow.</p>
                    <div class="features-grid">
                        <div class="feature-card reveal">
                            <i data-feather="edit" class="feature-icon"></i>
                            <h3>Editable Labels</h3>
                            <p>Rename all 8 sliders and knobs to perfectly match your DAW's parameters. Eliminate guesswork and stay in your creative flow.</p>
                        </div>
                        <div class="feature-card reveal" style="transition-delay: 0.1s;">
                            <i data-feather="bar-chart-2" class="feature-icon"></i>
                            <h3>Responsive Graphics</h3>
                            <p>Get instant, buttery-smooth visual feedback for every tweak. See your sound change in real time with our dynamic interface.</p>
                        </div>
                        <div class="feature-card reveal" style="transition-delay: 0.2s;">
                            <i data-feather="toggle-right" class="feature-icon"></i>
                            <h3>Configurable Buttons</h3>
                            <p>Map complex functions and trigger actions with fully customizable buttons. Your workflow, your rules.</p>
                        </div>
                        <!-- <div class="feature-card reveal" style="transition-delay: 0.3s;">
                            <i data-feather="layers" class="feature-icon"></i>
                            <h3>DAW Integration</h3>
                            <p>Works as an FX plugin in any major DAW. Drop it anywhere in your chain for maximum flexibility and convenience.</p>
                        </div> -->
                    </div>
                </div>
            </section>

            <section id="demo" class="section">
                <div class="container">
                    <h2 class="section-title reveal">See It In Action</h2>
                    <p class="section-subtitle reveal">Watch how Visualizer 1.0 can transform your music production experience.</p>
                    <div class="demo-video-wrapper reveal">
                        <iframe src="https://www.youtube.com/embed/9_nSaM-X2J0?si=2ayp3910K0EPGPoh" title="Visualizer 1.0 Demo Video" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                </div>
            </section>

            <section id="pricing" class="section">
                <div class="container">
                    <h2 class="section-title reveal">Get Visualizer 1.0 Today</h2>
                    <p class="section-subtitle reveal">A single purchase for a lifetime of creative clarity.</p>
                    <div class="pricing-card reveal">
                        <h3>Our first VST Plugin</h3>
                        <div class="pricing-price">
                            <span style="text-decoration: line-through; color: var(--color-text-muted); font-size: 2.5rem; margin-right: 10px;">
                                $39.99
                            </span>
                            <span style="color: var(--color-primary); font-size: 3.0rem; font-weight: bold;">$29.99</span>
                            <span style="background: var(--color-primary); color: #fff; font-size: 2.0rem; padding: 3px 62px; border-radius: 6px; margin-left: 8px;">
                                Limited Offer
                            </span>
                            </div>

                        <ul class="pricing-features">
                            <li><i data-feather="check-circle" class="icon"></i><span>Lifetime Updates Included</span></li>
                            <li><i data-feather="check-circle" class="icon"></i><span>Works with all Major DAWs</span></li>
                            <li><i data-feather="check-circle" class="icon"></i><span>30-Day Money-Back Guarantee</span></li>
                            <li><i data-feather="check-circle" class="icon"></i><span>Secure Instant Purchase</span></li>
                        </ul>
                        
                        <div id="paypal-button-container" style="margin-top: 30px;"></div>

                    </div>
                </div>
            </section>
        </main>

        <footer class="footer">
            <div class="container">
                <p>Â© 2025 The Faith Sound. All Rights Reserved.</p>
            </div>
        </footer>

        <script>
            // Initialize Feather Icons
            feather.replace();

            // Reveal on scroll animation
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, {
                threshold: 0.1
            });

            document.querySelectorAll('.reveal').forEach(el => {
                revealObserver.observe(el);
            });

            // --- STEP 2: The PayPal Script is now here, at the end of the body ---
            // This ensures the #paypal-button-container element exists before the script tries to render to it.
            paypal.Buttons({
                // Sets up the transaction when a payment button is clicked
                createOrder: function(data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            description: 'Visualizer 1.0 VST Plugin - Lifetime License',
                            amount: {
                                value: '29.99' // The price of your product
                            }
                        }]
                    });
                },
    // Sets up the actions to take when the buyer approves the transaction

                onApprove: function(data, actions) {
                    return actions.order.capture().then(orderDetails => {
                    const email = orderDetails.payer.email_address;  // PayPalâ€™s field

                    // show processingâ€¦
                    const container = document.getElementById('paypal-button-container');
                    container.innerHTML = '<h3>Processing your orderâ€¦</h3>';

                    // Call your Flask /add_user endpoint:
                    fetch('https://api.thefaithsound.com/add_user', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contact_email: email })
                    })
                    .then(r => r.json())
                    .then(result => {
                        if (result.pluginKey) {
                        container.innerHTML = `
                            <h3>Thank you!</h3>
                        <p>Your license key: 
                            <strong id="licenseKey">${result.pluginKey}</strong>
                            <button onclick="navigator.clipboard.writeText('${result.pluginKey}')">Copy</button>
                            </p>
                            <p>Weâ€™ve sent a confirmation email to ${email}.</p>
                        `;
                        } else {
                        container.innerHTML = `
                            <h3>Oops!</h3>
                            <p>${result.error || 'Could not create your license. Please contact us.'}</p>
                        `;
                        }
                    })
                    .catch(err => {
                        console.error(err);
                        container.innerHTML = '<h3>An error occurred. Please contact support.</h3>';
                    });
                    });
                },

                onError: function(err) {
                    console.error('PayPal error:', err);
                    alert('Payment error â€” please try again.');
                }
                }).render('#paypal-button-container');

        </script>
    </body>
    </html>